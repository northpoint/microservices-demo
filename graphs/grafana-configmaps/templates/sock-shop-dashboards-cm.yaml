apiVersion: v1
data:
  prometheus-stats-dashboard.json: |
    {"__inputs":[],"annotations":{"list":[]},"description":"","editable":true,"gnetId":null,"hideControls":false,"id":null,"links":[],"refresh":"10s","rows":[{"collapse":false,"editable":true,"height":"250px","panels":[{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":1,"description":null,"editable":true,"format":"s","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":1,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":4,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"(time() - process_start_time_seconds{job=\"monitoring/prometheus\"})","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Uptime","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":null,"description":null,"editable":true,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":2,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":4,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"targets":[{"datasource":"","expr":"prometheus_local_storage_memory_series","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Local Storage Memory Series","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":null,"description":null,"editable":true,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":3,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":4,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":true},"targets":[{"datasource":"","expr":"prometheus_local_storage_indexing_queue_length","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"500,4000","timeFrom":null,"title":"Internal Storage Queue Length","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"Empty","value":"0"}],"valueName":"current"}],"repeat":null,"showTitle":false,"title":"New row"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":4,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"rate(prometheus_local_storage_ingested_samples_total[5m])","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ job }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Samples ingested (rate-5m)","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true}]}],"repeat":null,"showTitle":false,"title":"New row"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":5,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"rate(prometheus_target_interval_length_seconds_count[5m])","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ job }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Target Scrapes (last 5m)","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":0,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":6,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"prometheus_target_interval_length_seconds{quantile!=\"0.01\", quantile!=\"0.05\"}","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ quantile }} ({{ interval }})","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Scrape Duration","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":false,"title":"New row"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":7,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"prometheus_evaluator_duration_milliseconds{quantile!=\"0.01\", quantile!=\"0.05\"}","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ quantile }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Rule Eval Duration","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"percentunit","label":null,"logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":false,"title":"New row"}],"schemaVersion":12,"sharedCrosshair":false,"style":"dark","tags":["sock-shop"],"templating":{"list":[]},"time":{"from":"now-3h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Prometheus Stats","uid":null,"version":0}
  k8s-pod-resources-dashboard.json: |
    {"__inputs":[],"annotations":{"list":[]},"description":"","editable":true,"gnetId":null,"hideControls":false,"id":null,"links":[],"refresh":"10s","rows":[{"collapse":false,"editable":true,"height":"180px","panels":[{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":null,"description":null,"editable":true,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":1,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":4,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum (container_memory_working_set_bytes{id=\"/\"}) / sum (machine_memory_bytes) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"65,90","timeFrom":null,"title":"Memory Working Set","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":2,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":4,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(rate(container_cpu_usage_seconds_total{id=\"/\",}[1m])) / sum (machine_cpu_cores) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":"10s","target":""}],"thresholds":"65,90","timeFrom":null,"title":"CPU Usage","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":3,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":4,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(container_fs_usage_bytes{id=\"/\"}) / sum(container_fs_limit_bytes{id=\"/\"}) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":"10s","target":""}],"thresholds":"65,90","timeFrom":null,"title":"Filesystem Usage","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":4,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(container_memory_working_set_bytes{id=\"/\"})","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Used","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":5,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(machine_memory_bytes)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Total","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":6,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":" cores","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(rate(container_cpu_usage_seconds_total{id=\"/\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Used","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":7,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":" cores","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(machine_cpu_cores)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Total","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":8,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(container_fs_usage_bytes{id=\"/\"})","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Used","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":9,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(container_fs_limit_bytes{id=\"/\"})","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Total","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":10,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(container_network_receive_bytes_total[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"receive","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"- sum(rate(container_network_transmit_bytes_total[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"transmit","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Network","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"Bps","label":"transmit / receive","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"Bps","label":null,"logBase":1,"max":null,"min":0,"show":false}]}],"repeat":null,"showTitle":true,"title":"all pods"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":11,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",namespace=\"sock-shop\"}[1m])) by (pod)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"CPU Usage","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":12,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\"}) by (pod_name)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Memory Working Set","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"bytes","label":"used","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"bytes","label":"used","logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":13,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",}[1m])) by (pod_name)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }} < in","metric":"network","refId":"A","step":"2","target":""},{"datasource":"","expr":"- sum (rate (container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",}[1m])) by (pod_name)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }} > out","metric":"network","refId":"B","step":"2","target":""}],"timeFrom":null,"timeShift":null,"title":"Network","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"Bps","label":"transmit / receive","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":14,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(container_fs_usage_bytes{image!=\"\",name=~\"^k8s_.*\"}) by (pod_name)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Filesystem","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"bytes","label":"used","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"repeat":null,"showTitle":true,"title":"each pod"}],"schemaVersion":12,"sharedCrosshair":false,"style":"dark","tags":["sock-shop"],"templating":{"list":[]},"time":{"from":"now-3h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Kubernetes Pod Resources","uid":null,"version":0}
  sock-shop-resources-dashboard.json: |
    {"__inputs":[],"annotations":{"list":[]},"description":"","editable":true,"gnetId":null,"hideControls":false,"id":null,"links":[],"refresh":"5s","rows":[{"collapse":false,"editable":true,"height":"180px","panels":[{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":null,"description":null,"editable":true,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":1,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":6,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(container_memory_working_set_bytes{namespace=\"sock-shop\"}) / sum(machine_memory_bytes{}) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"65,90","timeFrom":null,"title":"Memory","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"height":null,"hideTimeOverride":false,"id":2,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":6,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"sock-shop\"}[1m])) / sum (machine_cpu_cores) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":"10s","target":""}],"thresholds":"65,90","timeFrom":null,"title":"CPU Usage","transparent":false,"type":"singlestat","valueFontSize":"80%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":3,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":3,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(container_memory_working_set_bytes{namespace=\"sock-shop\"})","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Used","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":4,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":3,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(machine_memory_bytes)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Total","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":5,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":" cores","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":3,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"sock-shop\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Used","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"],"datasource":"Prometheus","decimals":2,"description":null,"editable":true,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"height":"1px","hideTimeOverride":false,"id":6,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"minSpan":null,"nullPointMode":"connected","nullText":null,"postfix":" cores","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[],"repeat":null,"span":3,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"datasource":"","expr":"sum(machine_cpu_cores)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"","metric":"","refId":"A","step":10,"target":""}],"thresholds":"","timeFrom":null,"title":"Total","transparent":false,"type":"singlestat","valueFontSize":"50%","valueMaps":[],"valueName":"current"}],"repeat":null,"showTitle":true,"title":"summary"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":7,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(container_memory_working_set_bytes{namespace=\"sock-shop\"}) by (pod_name)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Memory Working Set","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"bytes","label":"used","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"bytes","label":"used","logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":8,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":"200px","sort":null,"sortDesc":false,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":12,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"sock-shop\"}[1m])) by (pod_name)","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"{{ pod_name }}","metric":"","refId":"A","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"CPU Usage","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"decimals":null,"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":false,"title":"New row"}],"schemaVersion":12,"sharedCrosshair":false,"style":"dark","tags":["sock-shop"],"templating":{"list":[]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Socks Shop Resources","uid":null,"version":0}
  sock-shop-performance-dashboard.json: |
    {"__inputs":[],"annotations":{"list":[]},"description":"","editable":true,"gnetId":null,"hideControls":false,"id":null,"links":[],"refresh":"5s","rows":[{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":1,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"catalogue\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"catalogue\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Catalogue QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":2,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"catalogue\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"catalogue\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"catalogue\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"catalogue\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Catalogue Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"Catalogue"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":3,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"carts\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"carts\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Cart QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":4,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"carts\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"carts\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"carts\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"carts\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Cart Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"Cart"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":5,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"orders\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"orders\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Orders QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":6,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"orders\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"orders\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"orders\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"orders\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Orders Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"Orders"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":7,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"payment\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"payment\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Payment QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":8,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"payment\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"payment\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"payment\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"payment\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Payment Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"Payment"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":9,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"shipping\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"shipping\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Shipping QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":10,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"shipping\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"shipping\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"shipping\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"shipping\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Shipping Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"Shipping"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":11,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"user\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"user\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"User QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":12,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"user\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"user\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"user\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"user\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"User Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"User"},{"collapse":false,"editable":true,"height":"250px","panels":[{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":13,"isNew":true,"legend":{"alignAsTable":true,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"front-end\",status_code=~\"2..\",route!=\"metrics\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"2xx","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_count{name=\"front-end\",status_code=~\"4.+|5.+\"}[1m])) * 100","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"4xx/5xx","metric":"","refId":"B","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Front End QPS","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"ops","label":"QPS (1 min)","logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]},{"aliasColors":{},"bars":false,"datasource":"Prometheus","description":null,"editable":true,"error":false,"fill":1,"grid":{"threshold1":null,"threshold1Color":"rgba(216, 200, 27, 0.27)","threshold2":null,"threshold2Color":"rgba(234, 112, 112, 0.22)"},"id":14,"isNew":true,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":null,"sort":null,"sortDesc":false,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"minSpan":null,"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","repeat":null,"seriesOverrides":[],"span":6,"stack":false,"steppedLine":false,"targets":[{"datasource":"","expr":"histogram_quantile(0.99, sum(rate(request_duration_seconds_bucket{name=\"front-end\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"99th quantile","metric":"","refId":"A","step":10,"target":""},{"datasource":"","expr":"histogram_quantile(0.5, sum(rate(request_duration_seconds_bucket{name=\"front-end\"}[1m])) by (name, le))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"50th quantile","metric":"","refId":"B","step":10,"target":""},{"datasource":"","expr":"sum(rate(request_duration_seconds_sum{name=\"front-end\"}[1m])) / sum(rate(request_duration_seconds_count{name=\"front-end\"}[1m]))","format":"time_series","instant":false,"interval":"","intervalFactor":2,"legendFormat":"mean","metric":"","refId":"C","step":10,"target":""}],"timeFrom":null,"timeShift":null,"title":"Front End Latency","tooltip":{"msResolution":true,"shared":true,"sort":0,"value_type":"cumulative"},"transparent":false,"type":"graph","xaxis":{"show":true},"yaxes":[{"decimals":null,"format":"s","label":null,"logBase":1,"max":null,"min":0,"show":true},{"decimals":null,"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}]}],"repeat":null,"showTitle":true,"title":"Front End"}],"schemaVersion":12,"sharedCrosshair":false,"style":"dark","tags":["sock-shop"],"templating":{"list":[]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Sock Shop Performance","uid":null,"version":0}
  sock-shop-analytics-dashboard.json: |
    {"overwrite":true,"inputs":[{"name":"DS_PROMETHEUS","pluginId":"prometheus","type":"datasource","value":"prometheus"}],"dashboard":{"__inputs":[{"name":"DS_PROMETHEUS","label":"prometheus","description":"","type":"datasource","pluginId":"prometheus","pluginName":"Prometheus"}],"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"4.1.2"},{"type":"datasource","id":"prometheus","name":"Prometheus","version":"1.0.0"},{"type":"panel","id":"singlestat","name":"Singlestat","version":""}],"annotations":{"list":[]},"editable":true,"gnetId":null,"graphTooltip":0,"hideControls":false,"id":null,"links":[],"rows":[{"collapse":false,"height":190,"panels":[{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"${DS_PROMETHEUS}","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"id":1,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"span":2,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"expr":"request_duration_seconds_count{name=\"orders\",method=\"POST\"}","intervalFactor":1,"refId":"A","step":30}],"thresholds":"","title":"# Orders","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"${DS_PROMETHEUS}","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"id":2,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"span":5,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"expr":"rate(request_duration_seconds_count{name=\"orders\",method=\"POST\"}[1h]) *24*60*60","intervalFactor":1,"refId":"A","step":30}],"thresholds":"","title":"Projected number of orders per day","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"datasource":"${DS_PROMETHEUS}","format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"id":3,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"span":5,"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"targets":[{"expr":"request_duration_seconds_count{name=\"user\", route=\"login\",status_code=\"200\"}","intervalFactor":1,"refId":"A","step":30}],"thresholds":"","title":"# Logins","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"}],"repeat":null,"repeatIteration":null,"repeatRowId":null,"showTitle":false,"title":"Dashboard Row","titleSize":"h6"}],"schemaVersion":14,"style":"dark","tags":[],"templating":{"list":[]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Sock-Shop Analytics","version":2}}
  oth-overview-dashboard.json: |
    {"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":30,"iteration":1596563359319,"links":[],"panels":[{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":4,"panels":[],"title":"Logs","type":"row"},{"columns":[],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":10,"w":24,"x":0,"y":1},"id":2,"pageSize":25,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time (UTC)","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss.SSS","pattern":"TimeGenerated","type":"date"},{"alias":"Pod","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"PodName","thresholds":[],"type":"string","unit":"short"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat":"YYYY-MM-DD HH:mm:ss","decimals":2,"mappingType":1,"pattern":"/.*/","thresholds":[],"type":"string","unit":"short"}],"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated)\n| project ContainerID, PodName = Name, PodLabelJson = parse_json(PodLabel) \n| where $__contains(PodName, $podName)\n| join (\n    ContainerLog\n    | where $__timeFilter(TimeGenerated)\n) on ContainerID\n| project TimeGenerated, PodName, LogEntry, LogEntrySource\n| order by TimeGenerated desc","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"hide":false,"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Pod Logs","transform":"table","type":"table-old"},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":11},"id":11,"panels":[],"title":"Containers","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":12},"hiddenSeries":false,"id":13,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Namespace == \"sock-shop\" and Name !contains \"front-end\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Backend CPU Usage (Nano Cores)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":12},"hiddenSeries":false,"id":17,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Name contains \"front-end\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Frontend CPU Usage (Nano Cores)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":20},"hiddenSeries":false,"id":16,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Namespace == \"sock-shop\" and Name !contains \"front-end\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"memoryWorkingSetBytes\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) / 1024 / 1024 by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Backend Memory Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decmbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":20},"hiddenSeries":false,"id":18,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Name contains \"front-end\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"memoryWorkingSetBytes\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) / 1024 / 1024 by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Frontend Memory Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decmbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":28},"id":6,"panels":[],"title":"Databases","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":29},"hiddenSeries":false,"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Namespace == \"sock-shop\" and Name contains \"-db\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"DB CPU Usage (Nano Cores)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":37},"hiddenSeries":false,"id":8,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Namespace == \"sock-shop\" and Name contains \"-db\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"memoryWorkingSetBytes\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) / 1024 / 1024 by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"MongoDB Memory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decmbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":45},"id":20,"panels":[],"title":"K8S Metrics","type":"row"},{"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{},"decimals":2,"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":75},{"color":"red","value":90}]},"unit":"none"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":46},"id":22,"options":{"orientation":"auto","reduceOptions":{"calcs":["mean"],"fields":"","values":true},"showThresholdLabels":false,"showThresholdMarkers":true},"pluginVersion":"7.0.3","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubeNodeInventory\n| where ClusterName == \"$clusterName\"\n| distinct ClusterName, Computer\n| join hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'cpuCapacityNanoCores'\n    | summarize LimitValue = max(CounterValue) by Computer, CounterName\n    | project Computer, LimitValue\n) on Computer\n| join kind=inner hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'cpuUsageNanoCores'\n    | project Computer, UsageValue = CounterValue, TimeGenerated\n) on Computer\n| where $__timeFilter(TimeGenerated)\n| project Node = Computer, TimeGenerated, UsagePercent = UsageValue * 100 / LimitValue\n| summarize AvgUsagePercent = avg(UsagePercent) by TimeGenerated, Node\n| order by TimeGenerated desc\n| limit 3","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"% CPU Used by Node","type":"gauge"},{"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{},"decimals":2,"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"#EAB839","value":75},{"color":"red","value":90}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":46},"id":23,"options":{"orientation":"auto","reduceOptions":{"calcs":["mean"],"fields":"","values":true},"showThresholdLabels":false,"showThresholdMarkers":true},"pluginVersion":"7.0.3","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubeNodeInventory\n| where ClusterName == \"$clusterName\"\n| distinct ClusterName, Computer\n| join hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'memoryCapacityBytes'\n    | summarize LimitValue = max(CounterValue) by Computer, CounterName\n    | project Computer, LimitValue\n) on Computer\n| join kind=inner hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'memoryRssBytes'\n    | project Computer, UsageValue = CounterValue, TimeGenerated\n) on Computer\n| where $__timeFilter(TimeGenerated)\n| project Node = Computer, TimeGenerated, UsagePercent = UsageValue * 100 / LimitValue\n| summarize AvgUsagePercent = avg(UsagePercent) by TimeGenerated, Node\n| order by TimeGenerated desc\n| limit 3","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"% Memory Used by Node","type":"gauge"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":54},"hiddenSeries":false,"id":28,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubeNodeInventory\n| where ClusterName == \"$clusterName\"\n| distinct ClusterName, Computer\n| join hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'cpuCapacityNanoCores'\n    | summarize LimitValue = max(CounterValue) by Computer, CounterName\n    | project Computer, LimitValue\n) on Computer\n| join kind=inner hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'cpuUsageNanoCores'\n    | project Computer, UsageValue = CounterValue, TimeGenerated\n) on Computer\n| where $__timeFilter(TimeGenerated)\n| project Node = Computer, TimeGenerated, UsagePercent = UsageValue * 100 / LimitValue\n| summarize AvgUsagePercent = avg(UsagePercent) by TimeGenerated, Node\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"% CPU Used by Node Trend","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percent","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":54},"hiddenSeries":false,"id":29,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubeNodeInventory\n| where ClusterName == \"$clusterName\"\n| distinct ClusterName, Computer\n| join hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'memoryCapacityBytes'\n    | summarize LimitValue = max(CounterValue) by Computer, CounterName\n    | project Computer, LimitValue\n) on Computer\n| join kind=inner hint.strategy=shuffle (\n    Perf\n    | where ObjectName == 'K8SNode' and CounterName == 'memoryRssBytes'\n    | project Computer, UsageValue = CounterValue, TimeGenerated\n) on Computer\n| where $__timeFilter(TimeGenerated)\n| project Node = Computer, TimeGenerated, UsagePercent = UsageValue * 100 / LimitValue\n| summarize AvgUsagePercent = avg(UsagePercent) by TimeGenerated, Node\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"% Memory Used by Node Trend","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"percent","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":0,"y":62},"hiddenSeries":false,"id":26,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Name contains \"nginx\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Ingress CPU Usage (Nano Cores)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":12,"x":12,"y":62},"hiddenSeries":false,"id":27,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory\n| where $__timeFilter(TimeGenerated) and ClusterName == \"$clusterName\" and Name contains \"nginx\"\n//| where TimeGenerated > ago(30m) \n| extend ControllerEndName = split(ContainerName, '/')[1]\n| project PodName=Name, serviceNode = strcat(ControllerEndName, \"@\", Computer)\n| join (\n    Perf \n| where ObjectName == \"K8SContainer\" and CounterName == \"memoryWorkingSetBytes\"\n| where $__timeFilter(TimeGenerated)\n//| where TimeGenerated > ago(30m) \n| extend InstanceNameArray = split(InstanceName, '/')\n| extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8])\n| project ServiceProvider, AKS, ContainerService, Node = Computer, Computer, ObjectName, CounterName , CounterValue , TimeGenerated , serviceNode = strcat(ContainerService, \"@\" , Computer)\n) on serviceNode\n//| summarize AvgWorkingSetBytes = avg(CounterValue) by PodName, bin(TimeGenerated, 30m)\n| summarize AvgWorkingSetBytes = avg(CounterValue) / 1024 / 1024 by PodName, bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Ingress Memory Usage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decmbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"1m","schemaVersion":25,"style":"dark","tags":["OTH"],"templating":{"list":[{"allValue":null,"current":{"selected":false,"text":"Microservice-Demo","value":"Microservice-Demo"},"datasource":"Azure Monitor","definition":"KubeNodeInventory\n| where TimeGenerated > ago(15m)\n| distinct ClusterName","hide":0,"includeAll":false,"label":"Cluster","multi":false,"name":"clusterName","options":[],"query":"KubeNodeInventory\n| where TimeGenerated > ago(15m)\n| distinct ClusterName","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"Azure Monitor","definition":"KubePodInventory\n| where TimeGenerated > ago(15m) and ClusterName == \"$clusterName\"\n| extend PJL = parse_json(PodLabel)\n| project OTHClient = PJL[0][\"oth.ey.com/client\"]//, Node=Computer, PodName=Name, Namespace, Status=PodStatus \n| where OTHClient != \"\"","hide":0,"includeAll":true,"label":"Client (for logs)","multi":false,"name":"clientName","options":[],"query":"KubePodInventory\n| where TimeGenerated > ago(15m) and ClusterName == \"$clusterName\"\n| extend PJL = parse_json(PodLabel)\n| project OTHClient = PJL[0][\"oth.ey.com/client\"]//, Node=Computer, PodName=Name, Namespace, Status=PodStatus \n| where OTHClient != \"\"","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"selected":false,"text":"All","value":"$__all"},"datasource":"Azure Monitor","definition":"KubePodInventory\n| where TimeGenerated > ago(15m) and Namespace == \"sock-shop\"\n| project PodName = Name, PodLabelJson = parse_json(PodLabel) \n| distinct PodName","hide":0,"includeAll":true,"label":"Pod (for logs)","multi":false,"name":"podName","options":[],"query":"KubePodInventory\n| where TimeGenerated > ago(15m) and Namespace == \"sock-shop\"\n| project PodName = Name, PodLabelJson = parse_json(PodLabel) \n| distinct PodName","refresh":1,"regex":"","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"OTH AKS Overview","uid":"e8e0WxQZz","version":13}
  oth-aks-status-dashboard.json: |
    {"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"gnetId":null,"graphTooltip":0,"id":32,"iteration":1596571517499,"links":[],"panels":[{"aliasColors":{"Failed":"#C4162A","Running":"#73BF69"},"breakPoint":"50%","cacheTimeout":null,"combine":{"label":"Others","threshold":0},"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","format":"short","gridPos":{"h":6,"w":4,"x":0,"y":0},"id":29,"interval":null,"legend":{"percentage":false,"show":true,"values":false},"legendType":"Right side","links":[{"targetBlank":true,"title":"Error and Alerts $clusterName","url":"https://bigeye.sbp.eyclienthub.com/d/NoGU0LOZz/aks-container-alerts?orgId=26&var-clusterName=$clusterName"}],"maxDataPoints":3,"nullPointMode":"connected","pieType":"donut","strokeWidth":1,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"ContainerInventory\r\n| where TimeGenerated >= ago(30m)\r and _ResourceId endswith \"$clusterName\" //$__contains(Computer, $clusterNode)\r\n| summarize AggregatedValue = dcount(ContainerID) by ContainerState, bin(TimeGenerated, 1h)","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Container status last 30 minutes","type":"grafana-piechart-panel","valueName":"current"},{"columns":[],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":6,"w":9,"x":4,"y":0},"id":31,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":2,"desc":true},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":" KubePodInventory | where TimeGenerated > ago(5m)  | where Namespace !has \"kube-system\" and ClusterName =~ \"$clusterName\"\n | where not(isempty(Namespace)) \r\n | distinct Namespace, Name, PodStatus\r\n | summarize AggregatedValue = count(PodStatus) by Namespace, Name, PodStatus","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Pod By Namespace","transform":"table","type":"table-old"},{"collapsed":false,"datasource":null,"gridPos":{"h":1,"w":24,"x":0,"y":6},"id":8,"panels":[],"repeat":null,"title":"Status for $clusterName","type":"row"},{"cacheTimeout":null,"colorBackground":true,"colorPrefix":false,"colorValue":false,"colors":["#73BF69","#73BF69","#d44a3a"],"datasource":"Azure Monitor","description":"$clusterName","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":2,"x":0,"y":7},"id":5,"interval":null,"links":[{"targetBlank":true,"title":"$clusterName [Pod,Node,Disk,etc]","url":"https://bigeye.sbp.eyclienthub.com/d/9B-gTKdZk/aks-details-by-cluster-name?orgId=26&var-clusterName=$clusterName"},{"targetBlank":true,"title":"$clusterName Performance","url":"https://bigeye.sbp.eyclienthub.com/d/T38dkHdWk/aks-perf?orgId=26&var-clusterName=$clusterName&var-clusterNode=All&var-controllerName=coredns-7fbf4847b6&var-clusterContainerService=kube-proxy"}],"mappingType":2,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"#F2CC0C","show":false},"tableColumn":"","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let endDateTime = now();\r\nlet startDateTime = ago(3m);\r\nlet trendBinSize = 1m;\r\nKubeNodeInventory\r\n| where TimeGenerated < endDateTime\r\n| where TimeGenerated >= startDateTime\r | where ClusterName == \"$clusterName\" //search \"$clusterName\"\n| distinct ClusterName, Computer, TimeGenerated\r\n| summarize ClusterSnapshotCount = count() by bin(TimeGenerated, trendBinSize), ClusterName, Computer\r\n| join hint.strategy=broadcast kind=inner (\r\n    KubeNodeInventory\r\n    | where TimeGenerated < endDateTime\r\n    | where TimeGenerated >= startDateTime\r\n    | summarize TotalCount = count(), ReadyCount = sumif(1, Status contains ('Ready'))\r\n                by ClusterName, Computer,  bin(TimeGenerated, trendBinSize)\r\n    | extend NotReadyCount = TotalCount - ReadyCount\r\n) on ClusterName, Computer, TimeGenerated\r\n| project   TimeGenerated,\r\n            ClusterName,\r\n            Computer,\r\n            ReadyCount = todouble(ReadyCount) / ClusterSnapshotCount\r\n            //NotReadyCount = todouble(NotReadyCount) / ClusterSnapshotCount\r\n//| order by ClusterName asc, TimeGenerated desc//Computer asc, TimeGenerated desc\r\n| summarize  sum(ReadyCount) by bin(TimeGenerated,1s) , ClusterName \n| order by TimeGenerated asc | take 1","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":"","timeFrom":null,"timeShift":null,"title":"Node UP","transparent":true,"type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"$clusterName","value":"$clusterName"}],"valueName":"avg"},{"cacheTimeout":null,"colorBackground":true,"colorPrefix":false,"colorValue":false,"colors":["#73BF69","#FF7383","#d44a3a"],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":2,"x":2,"y":7},"id":6,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":false,"lineColor":"rgb(31, 120, 193)","show":false},"tableColumn":"","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let endDateTime = now();\r\nlet startDateTime = ago(3m);\r\nlet trendBinSize = 1m;\r\nKubeNodeInventory\r\n| where TimeGenerated < endDateTime\r\n| where TimeGenerated >= startDateTime\r | where ClusterName == \"$clusterName\" //search \"$clusterName\"\r\n| distinct ClusterName, Computer, TimeGenerated\r\n| summarize ClusterSnapshotCount = count() by bin(TimeGenerated, trendBinSize), ClusterName, Computer\r\n| join hint.strategy=broadcast kind=inner (\r\n    KubeNodeInventory\r\n    | where TimeGenerated < endDateTime\r\n    | where TimeGenerated >= startDateTime\r\n    | summarize TotalCount = count(), ReadyCount = sumif(1, Status contains ('Ready'))\r\n                by ClusterName, Computer,  bin(TimeGenerated, trendBinSize)\r\n    | extend NotReadyCount = TotalCount - ReadyCount\r\n) on ClusterName, Computer, TimeGenerated\r\n| project   TimeGenerated,\r\n            ClusterName,\r\n            Computer,\r\n            //ReadyCount = todouble(ReadyCount) / ClusterSnapshotCount\r\n            NotReadyCount = todouble(NotReadyCount) / ClusterSnapshotCount\r\n//| order by ClusterName asc, TimeGenerated desc//Computer asc, TimeGenerated desc\r\n| summarize  sum(NotReadyCount) by bin(TimeGenerated,1s) , ClusterName \n| order by TimeGenerated asc | take 1","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":"1","timeFrom":null,"timeShift":null,"title":"Node Down","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"3","value":"xzvfd"},{"op":"=","text":"","value":""}],"valueName":"avg"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":6,"w":19,"x":5,"y":7},"hiddenSeries":false,"id":16,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"InsightsMetrics\r\n| where $__timeFilter(TimeGenerated)\r\r\n| where Origin == 'container.azm.ms/telegraf'\r\n| where Namespace == 'container.azm.ms/net'\r\n| where Name == 'bytes_sent' and $__contains(Computer, $clusterNode)\r\n| extend Tags = todynamic(Tags)\r\n| extend HostName = tostring(Tags.hostName), Interface = tostring(Tags.interface)\r\n| where '*' in ('*') or HostName in ('*')\r\n| where '*' in ('*') or Interface in ('*')\r\n| extend partitionKey = strcat(HostName, '/', Interface)\r\n| order by partitionKey asc, TimeGenerated asc\r\n| serialize\r\n| extend PrevVal = iif(prev(partitionKey) != partitionKey, 0.0, prev(Val)), PrevTimeGenerated = iif(prev(partitionKey) != partitionKey, datetime(null), prev(TimeGenerated))\r\n| where isnotnull(PrevTimeGenerated) and PrevTimeGenerated != TimeGenerated\r\n| extend Rate = iif(PrevVal > Val, Val / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1), (Val - PrevVal) / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1))\r\n| where isnotnull(Rate)\r\n| project TimeGenerated, HostName, Interface, Rate | summarize avg(Rate) by HostName , bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Network bytes_sent","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"cacheTimeout":null,"colorBackground":true,"colorPrefix":false,"colorValue":false,"colors":["#56A64B","#73BF69","#d44a3a"],"datasource":"Azure Monitor","description":"","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":2,"x":0,"y":10},"id":9,"interval":null,"links":[],"mappingType":2,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"#F2CC0C","show":false},"tableColumn":"","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"KubePodInventory | where TimeGenerated > ago(2m) | where ClusterName == \"$clusterName\" //search \"$clusterName\"\n| project ControllerName,ControllerKind,ContainerStatus,ContainerID,PodUid,PodIp,PodName=Name,NodeName=Computer \r\n| summarize dcount(ControllerName)","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":"","timeFrom":null,"timeShift":null,"title":"Controller","transparent":true,"type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"$clusterName","value":"$clusterName"}],"valueName":"avg"},{"columns":[],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":5,"w":3,"x":2,"y":10},"id":14,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"KubePodInventory | where TimeGenerated > ago(2m) | where ClusterName == \"$clusterName\" //search \"$clusterName\"\n| project ControllerName,ControllerKind,ContainerStatus,ContainerID,PodUid,PodIp,PodName=Name,NodeName=Computer \r\n| summarize Count = dcount(ControllerName) by ControllerKind","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Controller Kind","transform":"table","type":"table-old"},{"cacheTimeout":null,"colorBackground":true,"colorPrefix":false,"colorValue":false,"colors":["#56A64B","#73BF69","#d44a3a"],"datasource":"Azure Monitor","description":"","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":2,"x":0,"y":13},"id":10,"interval":null,"links":[],"mappingType":2,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"#F2CC0C","show":false},"tableColumn":"","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"KubePodInventory | where TimeGenerated > ago(2m) |  where ClusterName == \"$clusterName\" // search \"$clusterName\"\n| project ControllerName,ControllerKind,ContainerStatus,ContainerID,PodUid,PodIp,PodName=Name,NodeName=Computer \r\n| summarize dcount(PodUid)","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":"","timeFrom":null,"timeShift":null,"title":"Pod","transparent":true,"type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"$clusterName","value":"$clusterName"}],"valueName":"avg"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":6,"w":19,"x":5,"y":13},"hiddenSeries":false,"id":17,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"InsightsMetrics\r\n| where $__timeFilter(TimeGenerated)\r\r\n| where Origin == 'container.azm.ms/telegraf'\r\n| where Namespace == 'container.azm.ms/net'\r\n| where Name == 'bytes_recv' and $__contains(Computer, $clusterNode)\r\n| extend Tags = todynamic(Tags)\r\n| extend HostName = tostring(Tags.hostName), Interface = tostring(Tags.interface)\r\n| where '*' in ('*') or HostName in ('*')\r\n| where '*' in ('*') or Interface in ('*')\r\n| extend partitionKey = strcat(HostName, '/', Interface)\r\n| order by partitionKey asc, TimeGenerated asc\r\n| serialize\r\n| extend PrevVal = iif(prev(partitionKey) != partitionKey, 0.0, prev(Val)), PrevTimeGenerated = iif(prev(partitionKey) != partitionKey, datetime(null), prev(TimeGenerated))\r\n| where isnotnull(PrevTimeGenerated) and PrevTimeGenerated != TimeGenerated\r\n| extend Rate = iif(PrevVal > Val, Val / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1), (Val - PrevVal) / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1))\r\n| where isnotnull(Rate)\r\n| project TimeGenerated, HostName, Interface, Rate | summarize avg(Rate) by HostName , bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Network bytes_recv","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"columns":[],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":4,"w":3,"x":2,"y":15},"id":13,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"KubePodInventory | where TimeGenerated > ago(2m) | where ClusterName == \"$clusterName\" //search \"$clusterName\"\n| project ControllerName,ControllerKind,ContainerStatus,ContainerID,PodUid,PodIp,PodName=Name,NodeName=Computer \r\n| summarize Count = dcount(ContainerID) by ContainerStatus","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Container Status","transform":"table","type":"table-old"},{"cacheTimeout":null,"colorBackground":true,"colorPrefix":false,"colorValue":false,"colors":["#56A64B","#73BF69","#d44a3a"],"datasource":"Azure Monitor","description":"","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":2,"x":0,"y":16},"id":11,"interval":null,"links":[],"mappingType":2,"mappingTypes":[{"name":"value to text","value":1},{"name":"range to text","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31, 118, 189, 0.18)","full":true,"lineColor":"#F2CC0C","show":false},"tableColumn":"","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"KubePodInventory | where TimeGenerated > ago(2m) | where ClusterName == \"$clusterName\" //search \"$clusterName\"\n| project ControllerName,ControllerKind,ContainerStatus,ContainerID,PodUid,PodIp,PodName=Name,NodeName=Computer \r\n| summarize dcount(ContainerID)","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":"","timeFrom":null,"timeShift":null,"title":"Container","transparent":true,"type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"$clusterName","value":"$clusterName"}],"valueName":"avg"},{"columns":[],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":8,"w":6,"x":0,"y":19},"id":21,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":0,"desc":true},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let data = InsightsMetrics\r | where $__timeFilter(TimeGenerated)\r\r\n| where Origin == 'container.azm.ms/telegraf'\r\n| where Namespace == 'container.azm.ms/prometheus'\r\n| where Name == 'kubelet_docker_operations' or Name == 'kubelet_docker_operations_errors'\r\n| extend Tags = todynamic(Tags)\r\n| extend OperationType = tostring(Tags['operation_type']), HostName = tostring(Tags.hostName)\r\n| where $__contains('*', $clusterNode)\r or $__contains(HostName, $clusterNode)\r\n| where '*' in ('*') or OperationType in ('*')\r\n| extend partitionKey = strcat(HostName, '/' , Name, '/', OperationType)\r\n| order by partitionKey asc, TimeGenerated asc\r\n| serialize\r\n| extend PrevVal = iif(prev(partitionKey) != partitionKey, 0.0, prev(Val)), PrevTimeGenerated = iif(prev(partitionKey) != partitionKey, datetime(null), prev(TimeGenerated))\r\n| where isnotnull(PrevTimeGenerated) and PrevTimeGenerated != TimeGenerated\r\n| extend Rate = iif(PrevVal > Val, Val, Val - PrevVal)\r\n| where isnotnull(Rate)\r\n| project TimeGenerated, Name, HostName, Rate;\r\nlet operationData = data\r\n| where Name == 'kubelet_docker_operations';\r\nlet totalOperationsByNode = operationData\r\n| summarize Rate = sum(Rate) by HostName\r\n| project HostName, TotalOperations = Rate;\r\nlet errorData = data\r\n| where Name == 'kubelet_docker_operations_errors';\r\nlet totalErrorsByNode = errorData\r\n| summarize Rate = sum(Rate) by HostName\r\n| project HostName, TotalErrors = Rate;\r\ntotalOperationsByNode\r\n| join kind=inner\r\n(\r\n    totalErrorsByNode\r\n)\r\non HostName\r\n| project-away HostName1;","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Kubelet Overview By Node","transform":"table","type":"table-old"},{"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{"align":null},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":6,"x":6,"y":19},"id":23,"links":[],"options":{"showHeader":true},"pluginVersion":"7.0.3","targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","timeColumn":"timestamp","timeGrain":"auto","valueColumn":""},"azureLogAnalytics":{"query":"KubePodInventory \n| where TimeGenerated > ago(2m) \n| where $__contains(Computer, $clusterNode) \n| project ControllerName,ControllerKind,ContainerStatus,PodIp,PodName=Name,NodeName=Computer \n| distinct PodName,ControllerName,ControllerKind,ContainerStatus,PodIp,NodeName","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Kubelet Overview By Operation Type","type":"table"},{"columns":[],"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fontSize":"100%","gridPos":{"h":8,"w":12,"x":12,"y":19},"id":27,"links":[],"pageSize":null,"scroll":true,"showHeader":true,"sort":{"col":3,"desc":false},"styles":[{"alias":"Time","align":"auto","dateFormat":"YYYY-MM-DD HH:mm:ss","pattern":"Time","type":"date"},{"alias":"","align":"auto","colorMode":null,"colors":["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals":2,"pattern":"/.*/","thresholds":[],"type":"number","unit":"short"}],"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"KubePodInventory | where TimeGenerated > ago(2m) |  where $__contains(Computer, $clusterNode)\r | project ControllerName,ControllerKind,ContainerStatus,PodIp,PodName=Name,NodeName=Computer | distinct PodName,ControllerName,ControllerKind,ContainerStatus,PodIp,NodeName ","resultFormat":"table","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"timeFrom":null,"timeShift":null,"title":"Pod running by Cluster / Node","transform":"table","type":"table-old"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":0,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":0,"y":27},"hiddenSeries":false,"id":25,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"                                    //this is a macro used to show the full chart’s time range, choose the datetime column here\nKubePodInventory | where $__timeFilter(TimeGenerated) | where ClusterName =~ \"$clusterName\" | project ControllerName,ControllerKind,ContainerStatus,ContainerID,PodUid,PodIp,PodName=Name,NodeName=Computer ,TimeGenerated\r\n| summarize dcount(PodUid) by NodeName , bin(TimeGenerated , 1m) | order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Pod count by Node","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":12,"y":27},"hiddenSeries":false,"id":18,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"InsightsMetrics\r\n| where $__timeFilter(TimeGenerated)\r\r\n| where Origin == 'container.azm.ms/telegraf'\r\n| where Namespace == 'container.azm.ms/net'\r\n| where Name == 'err_in' and $__contains(Computer, $clusterNode)\r\n| extend Tags = todynamic(Tags)\r\n| extend HostName = tostring(Tags.hostName), Interface = tostring(Tags.interface)\r\n| where '*' in ('*') or HostName in ('*')\r\n| where '*' in ('*') or Interface in ('*')\r\n| extend partitionKey = strcat(HostName, '/', Interface)\r\n| order by partitionKey asc, TimeGenerated asc\r\n| serialize\r\n| extend PrevVal = iif(prev(partitionKey) != partitionKey, 0.0, prev(Val)), PrevTimeGenerated = iif(prev(partitionKey) != partitionKey, datetime(null), prev(TimeGenerated))\r\n| where isnotnull(PrevTimeGenerated) and PrevTimeGenerated != TimeGenerated\r\n| extend Rate = iif(PrevVal > Val, Val / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1), (Val - PrevVal) / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1))\r\n| where isnotnull(Rate)\r\n| project TimeGenerated, HostName, Interface, Rate | summarize avg(Rate) by HostName , bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Network err_in","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":0,"y":33},"hiddenSeries":false,"id":19,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"InsightsMetrics\r\n| where $__timeFilter(TimeGenerated)\r\r\n| where Origin == 'container.azm.ms/telegraf'\r\n| where Namespace == 'container.azm.ms/net'\r\n| where Name == 'err_out' and $__contains(Computer, $clusterNode)\r\n| extend Tags = todynamic(Tags)\r\n| extend HostName = tostring(Tags.hostName), Interface = tostring(Tags.interface)\r\n| where '*' in ('*') or HostName in ('*')\r\n| where '*' in ('*') or Interface in ('*')\r\n| extend partitionKey = strcat(HostName, '/', Interface)\r\n| order by partitionKey asc, TimeGenerated asc\r\n| serialize\r\n| extend PrevVal = iif(prev(partitionKey) != partitionKey, 0.0, prev(Val)), PrevTimeGenerated = iif(prev(partitionKey) != partitionKey, datetime(null), prev(TimeGenerated))\r\n| where isnotnull(PrevTimeGenerated) and PrevTimeGenerated != TimeGenerated\r\n| extend Rate = iif(PrevVal > Val, Val / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1), (Val - PrevVal) / (datetime_diff('Second', TimeGenerated, PrevTimeGenerated) * 1))\r\n| where isnotnull(Rate)\r\n| project TimeGenerated, HostName, Interface, Rate | summarize avg(Rate) by HostName , bin(TimeGenerated, $__interval)\n| order by TimeGenerated asc","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Network err_out","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":6,"w":12,"x":12,"y":33},"hiddenSeries":false,"id":3,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","repeat":null,"repeatDirection":"h","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let FromUnixTime = (t:long) { datetime(1970-01-01) + t * 1sec };\r\nlet endDateTime = FromUnixTime(substring($__to,0,10));\r\nlet startDateTime = FromUnixTime(substring($__from,0,10));let trendBinSize = 1m;\r\n//let clusterName = $clusterName;\r\nKubeNodeInventory\r\n| where TimeGenerated < endDateTime\r\n| where TimeGenerated >= startDateTime\r | where ClusterName == \"$clusterName\" //search \"$clusterName\"\r\n| distinct ClusterName, Computer, TimeGenerated\r\n| summarize ClusterSnapshotCount = count() by bin(TimeGenerated, trendBinSize), ClusterName, Computer\r\n| join hint.strategy=broadcast kind=inner (\r\n    KubeNodeInventory\r\n    | where TimeGenerated < endDateTime\r\n    | where TimeGenerated >= startDateTime\r\n    | summarize TotalCount = count(), ReadyCount = sumif(1, Status contains ('Ready'))\r\n                by ClusterName, Computer,  bin(TimeGenerated, trendBinSize)\r\n    | extend NotReadyCount = TotalCount - ReadyCount\r\n) on ClusterName, Computer, TimeGenerated\r\n| project   TimeGenerated,\r\n            ClusterName,\r\n            Computer,\r\n            //ReadyCount = todouble(ReadyCount) / ClusterSnapshotCount\r\n            NotReadyCount = todouble(NotReadyCount) / ClusterSnapshotCount\r\n//| order by ClusterName asc, TimeGenerated desc//Computer asc, TimeGenerated desc\r\n| summarize  sum(NotReadyCount) by bin(TimeGenerated,1s) , ClusterName\n| order by TimeGenerated asc\r","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"B","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"},{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let FromUnixTime = (t:long) { datetime(1970-01-01) + t * 1sec };\r\nlet endDateTime = FromUnixTime(substring($__to,0,10));\r\nlet startDateTime = FromUnixTime(substring($__from,0,10));let trendBinSize = 1m;\r\n//let clusterName = $clusterName;\r\nKubeNodeInventory\r\n| where TimeGenerated < endDateTime\r\n| where TimeGenerated >= startDateTime\r | search \"$clusterName\"\r\n| distinct ClusterName, Computer, TimeGenerated\r\n| summarize ClusterSnapshotCount = count() by bin(TimeGenerated, trendBinSize), ClusterName, Computer\r\n| join hint.strategy=broadcast kind=inner (\r\n    KubeNodeInventory\r\n    | where TimeGenerated < endDateTime\r\n    | where TimeGenerated >= startDateTime\r\n    | summarize TotalCount = count(), ReadyCount = sumif(1, Status contains ('Ready'))\r\n                by ClusterName, Computer,  bin(TimeGenerated, trendBinSize)\r\n    | extend NotReadyCount = TotalCount - ReadyCount\r\n) on ClusterName, Computer, TimeGenerated\r\n| project   TimeGenerated,\r\n            ClusterName,\r\n            Computer,\r\n            //ReadyCount = todouble(ReadyCount) / ClusterSnapshotCount\r\n            NotReadyCount = todouble(NotReadyCount) / ClusterSnapshotCount\r\n//| order by ClusterName asc, TimeGenerated desc//Computer asc, TimeGenerated desc\r\n| summarize  sum(NotReadyCount) by bin(TimeGenerated,1s) , Computer \n| order by TimeGenerated asc\r","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"AKS node Not ready status (Cluster & Node) for $clusterName","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"Azure Monitor","fieldConfig":{"defaults":{"custom":{}},"overrides":[]},"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":12,"x":0,"y":39},"hiddenSeries":false,"id":2,"legend":{"alignAsTable":true,"avg":false,"current":false,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"dataLinks":[]},"percentage":false,"pointradius":2,"points":false,"renderer":"flot","repeat":null,"repeatDirection":"h","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let FromUnixTime = (t:long) { datetime(1970-01-01) + t * 1sec };\r\nlet endDateTime = FromUnixTime(substring($__to,0,10));\r\nlet startDateTime = FromUnixTime(substring($__from,0,10));let trendBinSize = 1m;\r\n//let clusterName = $clusterName;\r\nKubeNodeInventory\r\n| where TimeGenerated < endDateTime\r\n| where TimeGenerated >= startDateTime\r | where ClusterName == \"$clusterName\" //search \"$clusterName\"\r\n| distinct ClusterName, Computer, TimeGenerated\r \n| summarize ClusterSnapshotCount = count() by bin(TimeGenerated, trendBinSize), ClusterName, Computer\r\n| join hint.strategy=broadcast kind=inner (\r\n    KubeNodeInventory\r\n    | where TimeGenerated < endDateTime\r\n    | where TimeGenerated >= startDateTime\r\n    | summarize TotalCount = count(), ReadyCount = sumif(1, Status contains ('Ready'))\r\n                by ClusterName, Computer,  bin(TimeGenerated, trendBinSize)\r\n    | extend NotReadyCount = TotalCount - ReadyCount\r\n) on ClusterName, Computer, TimeGenerated\r\n| project   TimeGenerated,\r\n            ClusterName,\r\n            Computer,\r\n            ReadyCount = todouble(ReadyCount) / ClusterSnapshotCount\r\n            //NotReadyCount = todouble(NotReadyCount) / ClusterSnapshotCount\r\n//| order by ClusterName asc, TimeGenerated desc//Computer asc, TimeGenerated desc\r\n| summarize  sum(ReadyCount) by bin(TimeGenerated,1s) , ClusterName\n| order by TimeGenerated asc\r","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"B","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"},{"appInsights":{"dimension":"none","metricName":"select","rawQuery":false,"rawQueryString":"","spliton":"","timeColumn":"timestamp","timeGrain":"auto","timeGrainType":"auto","valueColumn":"","yaxis":""},"azureLogAnalytics":{"query":"let FromUnixTime = (t:long) { datetime(1970-01-01) + t * 1sec };\r\nlet endDateTime = FromUnixTime(substring($__to,0,10));\r\nlet startDateTime = FromUnixTime(substring($__from,0,10));let trendBinSize = 1m;\r\n//let clusterName = $clusterName;\r\nKubeNodeInventory\r\n| where TimeGenerated < endDateTime\r\n| where TimeGenerated >= startDateTime\r | search \"$clusterName\"\r\n| distinct ClusterName, Computer, TimeGenerated\r\n| summarize ClusterSnapshotCount = count() by bin(TimeGenerated, trendBinSize), ClusterName, Computer\r\n| join hint.strategy=broadcast kind=inner (\r\n    KubeNodeInventory\r\n    | where TimeGenerated < endDateTime\r\n    | where TimeGenerated >= startDateTime\r\n    | summarize TotalCount = count(), ReadyCount = sumif(1, Status contains ('Ready'))\r\n                by ClusterName, Computer,  bin(TimeGenerated, trendBinSize)\r\n    | extend NotReadyCount = TotalCount - ReadyCount\r\n) on ClusterName, Computer, TimeGenerated\r\n| project   TimeGenerated,\r\n            ClusterName,\r\n            Computer,\r\n            ReadyCount = todouble(ReadyCount) / ClusterSnapshotCount\r\n            //NotReadyCount = todouble(NotReadyCount) / ClusterSnapshotCount\r\n//| order by ClusterName asc, TimeGenerated desc//Computer asc, TimeGenerated desc\r\n| summarize  sum(ReadyCount) by bin(TimeGenerated,1s) , Computer \n| order by TimeGenerated asc\r","resultFormat":"time_series","workspace":"cefdab32-3c17-4f05-bffc-2af15660387c"},"azureMonitor":{"aggOptions":[],"dimensionFilter":"*","metricDefinition":"select","metricName":"select","metricNamespace":"select","resourceGroup":"select","resourceName":"select","timeGrain":"auto","timeGrains":[],"top":"10"},"queryType":"Azure Log Analytics","refId":"A","subscription":"9df57aae-baa1-4c88-b9ff-801541c1c45b"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"AKS node ready status (Cluster & Node) for $clusterName","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":false,"schemaVersion":25,"style":"dark","tags":["OTH"],"templating":{"list":[{"allValue":null,"current":{"selected":false,"text":"Microservice-Demo","value":"Microservice-Demo"},"datasource":"Azure Monitor","definition":" Perf | where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\" | extend InstanceNameArray = split(InstanceName, '/') | extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8]) | project AKS ","hide":0,"includeAll":false,"label":null,"multi":false,"name":"clusterName","options":[],"query":" Perf | where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\" | extend InstanceNameArray = split(InstanceName, '/') | extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8]) | project AKS ","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":"","current":{"selected":false,"text":"All","value":"$__all"},"datasource":"Azure Monitor","definition":"Perf  | where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\"  | extend InstanceNameArray = split(InstanceName, '/') | extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8]) , Computer | search \"$clusterName\" |project Computer","hide":0,"includeAll":true,"label":null,"multi":false,"name":"clusterNode","options":[],"query":"Perf  | where ObjectName == \"K8SContainer\" and CounterName == \"cpuUsageNanoCores\"  | extend InstanceNameArray = split(InstanceName, '/') | extend ServiceProvider = tostring(InstanceNameArray[6]) , ContainerService = tostring(InstanceNameArray[10]) , AKS = tostring(InstanceNameArray[8]) , Computer | search \"$clusterName\" |project Computer","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-3h","to":"now"},"timepicker":{"refresh_intervals":["5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"OTH AKS Status","uid":"rfS5cKOZz","version":5}

kind: ConfigMap
metadata:
  name: grafana-import-dashboards
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
